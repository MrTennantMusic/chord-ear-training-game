<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1">&lt;meta charset="UTF-8" /&gt;</p>
<p class="p1">&lt;title&gt;Chord Ear Training Game — Improved&lt;/title&gt;</p>
<p class="p1">&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>body { font-family: Arial, sans-serif; text-align: center; padding: 30px; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>button { font-size: 18px; margin: 10px; padding: 10px 20px; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>#feedback { font-size: 24px; margin-top: 20px; height: 40px; }</p>
<p class="p1"><span class="Apple-converted-space">  </span>#score { font-size: 20px; margin-top: 10px; }</p>
<p class="p1">&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;h1&gt;Chord Ear Training Game&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;p&gt;Listen to the chord and guess the chord type:&lt;/p&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;button id="playBtn"&gt;Play Chord&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;button onclick="guessChord('added6th')"&gt;Added 6th&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;button onclick="guessChord('dom7th')"&gt;Dominant 7th&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;button onclick="guessChord('dim7th')"&gt;Diminished 7th&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div id="feedback"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div id="score"&gt;Score: 0&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>const audioCtx = new (window.AudioContext || window.webkitAudioContext)();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const chordTypes = {</p>
<p class="p1"><span class="Apple-converted-space">    </span>added6th: [0, 4, 7, 9],</p>
<p class="p1"><span class="Apple-converted-space">    </span>dom7th: [0, 4, 7, 10],</p>
<p class="p1"><span class="Apple-converted-space">    </span>dim7th: [0, 3, 6, 9]</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const roots = {</p>
<p class="p1"><span class="Apple-converted-space">    </span>C: 261.63,</p>
<p class="p1"><span class="Apple-converted-space">    </span>D: 293.66,</p>
<p class="p1"><span class="Apple-converted-space">    </span>E: 329.63,</p>
<p class="p1"><span class="Apple-converted-space">    </span>F: 349.23,</p>
<p class="p1"><span class="Apple-converted-space">    </span>G: 392.00,</p>
<p class="p1"><span class="Apple-converted-space">    </span>A: 440.00,</p>
<p class="p1"><span class="Apple-converted-space">    </span>B: 493.88</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const waveTypes = ['sine', 'square', 'triangle', 'sawtooth'];</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>let score = 0;</p>
<p class="p1"><span class="Apple-converted-space">  </span>let chordToGuess = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function freqFromRoot(rootFreq, semitones) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>return rootFreq * Math.pow(2, semitones / 12);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function playTone(freq, duration, waveform, startTime) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const osc = audioCtx.createOscillator();</p>
<p class="p1"><span class="Apple-converted-space">    </span>const gainNode = audioCtx.createGain();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>osc.type = waveform;</p>
<p class="p1"><span class="Apple-converted-space">    </span>osc.frequency.value = freq;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>osc.connect(gainNode);</p>
<p class="p1"><span class="Apple-converted-space">    </span>gainNode.connect(audioCtx.destination);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>gainNode.gain.setValueAtTime(0, startTime);</p>
<p class="p1"><span class="Apple-converted-space">    </span>gainNode.gain.linearRampToValueAtTime(0.4, startTime + 0.02);</p>
<p class="p1"><span class="Apple-converted-space">    </span>gainNode.gain.exponentialRampToValueAtTime(0.001, startTime + duration);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>osc.start(startTime);</p>
<p class="p1"><span class="Apple-converted-space">    </span>osc.stop(startTime + duration);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function playChord(rootFreq, intervals, waveform, when) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const noteDuration = 0.6;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const chordDuration = 1.2;</p>
<p class="p1"><span class="Apple-converted-space">    </span>const notes = intervals.map(i =&gt; freqFromRoot(rootFreq, i));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Broken chord notes</p>
<p class="p1"><span class="Apple-converted-space">    </span>notes.forEach((f, i) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>playTone(f, noteDuration, waveform, when + i * noteDuration);</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>// Block chord together</p>
<p class="p1"><span class="Apple-converted-space">    </span>const blockStart = when + notes.length * noteDuration;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const gainNode = audioCtx.createGain();</p>
<p class="p1"><span class="Apple-converted-space">    </span>gainNode.connect(audioCtx.destination);</p>
<p class="p1"><span class="Apple-converted-space">    </span>gainNode.gain.setValueAtTime(0, blockStart);</p>
<p class="p1"><span class="Apple-converted-space">    </span>gainNode.gain.linearRampToValueAtTime(0.4, blockStart + 0.02);</p>
<p class="p1"><span class="Apple-converted-space">    </span>gainNode.gain.exponentialRampToValueAtTime(0.001, blockStart + chordDuration);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>notes.forEach(freq =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>const osc = audioCtx.createOscillator();</p>
<p class="p1"><span class="Apple-converted-space">      </span>osc.type = waveform;</p>
<p class="p1"><span class="Apple-converted-space">      </span>osc.frequency.value = freq;</p>
<p class="p1"><span class="Apple-converted-space">      </span>osc.connect(gainNode);</p>
<p class="p1"><span class="Apple-converted-space">      </span>osc.start(blockStart);</p>
<p class="p1"><span class="Apple-converted-space">      </span>osc.stop(blockStart + chordDuration);</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function getRandomChord() {</p>
<p class="p1"><span class="Apple-converted-space">    </span>const chordKeys = Object.keys(chordTypes);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const chordType = chordKeys[Math.floor(Math.random() * chordKeys.length)];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const rootNames = Object.keys(roots);</p>
<p class="p1"><span class="Apple-converted-space">    </span>const rootName = rootNames[Math.floor(Math.random() * rootNames.length)];</p>
<p class="p1"><span class="Apple-converted-space">    </span>const waveform = waveTypes[Math.floor(Math.random() * waveTypes.length)];</p>
<p class="p1"><span class="Apple-converted-space">    </span>return {</p>
<p class="p1"><span class="Apple-converted-space">      </span>chordType,</p>
<p class="p1"><span class="Apple-converted-space">      </span>rootName,</p>
<p class="p1"><span class="Apple-converted-space">      </span>rootFreq: roots[rootName],</p>
<p class="p1"><span class="Apple-converted-space">      </span>intervals: chordTypes[chordType],</p>
<p class="p1"><span class="Apple-converted-space">      </span>waveform</p>
<p class="p1"><span class="Apple-converted-space">    </span>};</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>const feedbackEl = document.getElementById('feedback');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const scoreEl = document.getElementById('score');</p>
<p class="p1"><span class="Apple-converted-space">  </span>const playBtn = document.getElementById('playBtn');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function newChord() {</p>
<p class="p1"><span class="Apple-converted-space">    </span>chordToGuess = getRandomChord();</p>
<p class="p1"><span class="Apple-converted-space">    </span>feedbackEl.textContent = '';</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>playBtn.onclick = function() {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (audioCtx.state === 'suspended') {</p>
<p class="p1"><span class="Apple-converted-space">      </span>audioCtx.resume();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>playChord(</p>
<p class="p1"><span class="Apple-converted-space">      </span>chordToGuess.rootFreq,</p>
<p class="p1"><span class="Apple-converted-space">      </span>chordToGuess.intervals,</p>
<p class="p1"><span class="Apple-converted-space">      </span>chordToGuess.waveform,</p>
<p class="p1"><span class="Apple-converted-space">      </span>audioCtx.currentTime + 0.1</p>
<p class="p1"><span class="Apple-converted-space">    </span>);</p>
<p class="p1"><span class="Apple-converted-space">  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function guessChord(type) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (!chordToGuess) return;</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (type === chordToGuess.chordType) {</p>
<p class="p1"><span class="Apple-converted-space">      </span>feedbackEl.textContent = '✅ Correct!';</p>
<p class="p1"><span class="Apple-converted-space">      </span>feedbackEl.style.color = 'green';</p>
<p class="p1"><span class="Apple-converted-space">      </span>score++;</p>
<p class="p1"><span class="Apple-converted-space">    </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">      </span>feedbackEl.textContent = `❌ Wrong. It was ${formatChordName(chordToGuess.chordType)}.`;</p>
<p class="p1"><span class="Apple-converted-space">      </span>feedbackEl.style.color = 'red';</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>scoreEl.textContent = `Score: ${score}`;</p>
<p class="p1"><span class="Apple-converted-space">    </span>setTimeout(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">      </span>newChord();</p>
<p class="p1"><span class="Apple-converted-space">    </span>}, 2000);</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>function formatChordName(name) {</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (name === 'added6th') return 'Added 6th';</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (name === 'dom7th') return 'Dominant 7th';</p>
<p class="p1"><span class="Apple-converted-space">    </span>if (name === 'dim7th') return 'Diminished 7th';</p>
<p class="p1"><span class="Apple-converted-space">    </span>return name;</p>
<p class="p1"><span class="Apple-converted-space">  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>newChord();</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
